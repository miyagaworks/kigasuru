# セキュリティポリシー

## サポートされているバージョン

現在、以下のバージョンがセキュリティアップデートの対象です：

| バージョン | サポート状況 |
| ------- | ---------- |
| main    | ✅ サポート中 |

## 脆弱性の報告

セキュリティ上の問題を発見された場合は、以下の方法でご報告ください：

1. **非公開で報告**: GitHubのSecurity Advisoryを使用してください
2. **メール**: support@kigasuru.com までご連絡ください

### 報告内容に含めていただきたい情報

- 脆弱性の種類（XSS、SQLインジェクション、認証バイパスなど）
- 影響範囲
- 再現手順
- 可能であれば、修正案やパッチ

## セキュリティ対策

このプロジェクトでは以下のセキュリティ対策を実施しています：

### 認証・認可
- NextAuth.js v5による認証
- ログイン試行回数制限（5回失敗で15分ロック）
- 二要素認証（TOTP）
- WebAuthn（パスキー/生体認証）
- IPアドレス制限（ブラックリスト/ホワイトリスト）
- 国別アクセス制限

### データ保護
- Prisma ORMによるSQLインジェクション対策
- Next.js/ReactによるXSS対策
- 暗号化された秘密鍵保存（AES-256-CBC）
- セッション管理の徹底

### 監視・通知
- ログインイベント記録
- 新しいIPからのログイン時にメール通知
- デバイス情報とジオロケーション記録

### 開発プロセス
- CodeQLによる自動脆弱性スキャン（週次）
- Dependabotによる依存関係の自動更新
- TypeScript厳格モード
- ESLintによるコード品質チェック

## 対応プロセス

1. **報告受理**: 24時間以内に受理確認
2. **調査**: 3営業日以内に初期調査完了
3. **修正**: 重大度に応じて優先度を設定
   - Critical: 24時間以内
   - High: 7日以内
   - Medium: 30日以内
   - Low: 90日以内
4. **公開**: 修正後、適切な期間を経て公開

## 連絡先

- Email: support@kigasuru.com
- GitHub Security Advisory: [リポジトリのSecurity タブ](https://github.com/miyagawakiyomi/kigasuru/security)
